<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Game Score</title>

<style>
:root{
  color-scheme: dark;
  --bg:#000;
  --card:#111;
  --border:#333;
  --btn:#1e88e5;
  --red:#c62828;     /* TOP */
  --green:#2e7d32;   /* LOW */
  --muted:#999;
}

body{
  margin:0;
  font-family:system-ui,-apple-system;
  background:var(--bg);
  color:#fff;
}

h1{margin:16px}
.card{
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  margin:16px;
  background:var(--card);
}

.row{display:flex;gap:10px;flex-wrap:wrap}
button,input{
  padding:10px 14px;
  border-radius:12px;
  border:1px solid var(--border);
  background:#222;
  color:#fff;
  font-size:15px;
}
button.primary{background:var(--btn);border:none;font-weight:700}
button:active{opacity:.8}
input{width:60px;text-align:center}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:12px;
}
th,td{
  padding:10px;
  border-bottom:1px solid var(--border);
}
tr.top{background:var(--red)}
tr.low{background:var(--green)}
tr.out{opacity:.4}

.history{
  font-size:13px;
  color:var(--muted);
  margin-top:8px;
}

.small{font-size:13px;color:var(--muted)}
</style>
</head>

<body>

<h1>ğŸ® Game Score</h1>

<div class="card" id="setup">
  <div class="row">
    <label>Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</label>
    <input id="playersCount" type="number" min="2" max="10" value="2">
    <button class="primary" onclick="startGame()">Ø§Ø¨Ø¯Ø£ / Ù„Ø¹Ø¨Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
  </div>

  <div class="row" style="margin-top:10px">
    <label>Ø§Ù„Ù„ØºØ©</label>
    <button onclick="setLang('ar')">AR</button>
    <button onclick="setLang('en')">EN</button>
  </div>

  <p class="small">Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ù‡Ø§Ø²</p>
</div>

<div class="card" id="game" style="display:none">
  <div class="row">
    <button onclick="addRound()">â• Ø¬ÙˆÙ„Ø©</button>
    <button onclick="addPlayer()">ğŸ‘¤ Ù„Ø§Ø¹Ø¨</button>
    <button onclick="resetGame()">ğŸ”„ ØªØµÙÙŠØ±</button>
  </div>

  <div class="row" style="margin-top:10px">
    <label>Ø§Ù„Ø¥Ù‚ØµØ§Ø¡ Ø¹Ù†Ø¯</label>
    <input id="target" type="number" value="100" onchange="save()">
  </div>

  <table id="table">
    <thead>
      <tr>
        <th>Ø§Ù„Ù„Ø§Ø¹Ø¨</th>
        <th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="history" id="history"></div>
</div>

<script>
let state={
  lang:"ar",
  names:[],
  totals:[],
  out:[],
  history:[]
};

function save(){
  localStorage.setItem("gameScore",JSON.stringify(state));
}
function load(){
  let s=localStorage.getItem("gameScore");
  if(s){state=JSON.parse(s);render();}
}

function setLang(l){
  state.lang=l;
  document.documentElement.lang=l;
  document.documentElement.dir=l==="ar"?"rtl":"ltr";
  save();
}

function startGame(){
  let n=+playersCount.value;
  state.names=[];
  state.totals=[];
  state.out=[];
  state.history=[];
  for(let i=0;i<n;i++){
    state.names.push("Player "+(i+1));
    state.totals.push(0);
    state.out.push(false);
  }
  save();
  render();
}

function render(){
  setup.style.display="none";
  game.style.display="block";

  let max=Math.max(...state.totals.filter((_,i)=>!state.out[i]));
  let min=Math.min(...state.totals.filter((_,i)=>!state.out[i]));

  let tbody=document.querySelector("#table tbody");
  tbody.innerHTML="";

  state.names.forEach((name,i)=>{
    let tr=document.createElement("tr");
    if(!state.out[i] && state.totals[i]===max) tr.classList.add("top");
    if(!state.out[i] && state.totals[i]===min) tr.classList.add("low");
    if(state.out[i]) tr.classList.add("out");

    tr.innerHTML=`
      <td onclick="editName(${i})">${name}${state.out[i]?" (OUT)":""}</td>
      <td>${state.totals[i]}</td>
    `;
    tbody.appendChild(tr);
  });

  history.innerHTML=state.history.map(h=>"â€¢ "+h).join("<br>");
}

function addRound(){
  let round=[];
  for(let i=0;i<state.names.length;i++){
    if(state.out[i]) continue;
    let v=prompt(state.names[i],"0");
    if(v===null) return;
    let n=+v||0;
    state.totals[i]+=n;
    round.push(`${state.names[i]} +${n}`);
    if(state.totals[i]>=target.value) state.out[i]=true;
  }
  state.history.unshift("Ø¬ÙˆÙ„Ø©: "+round.join(", "));
  save();
  render();
}

function addPlayer(){
  let name=prompt("Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨","Player "+(state.names.length+1));
  if(!name) return;
  state.names.push(name);
  state.totals.push(0);
  state.out.push(false);
  save();
  render();
}

function editName(i){
  let n=prompt("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø³Ù…",state.names[i]);
  if(!n) return;
  state.names[i]=n;
  save();
  render();
}

function resetGame(){
  if(!confirm("ØªØµÙÙŠØ± ÙƒÙ„ Ø§Ù„Ù†Ù‚Ø§Ø·ØŸ"))return;
  state.totals=state.totals.map(()=>0);
  state.out=state.out.map(()=>false);
  state.history=[];
  save();
  render();
}

load();
</script>
</body>
</html>
